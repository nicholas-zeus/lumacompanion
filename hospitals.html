<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Hospitals — Import CSV</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <link rel="stylesheet" href="/css/app.css" />

  <style>
    /* Page shell (keeps consistent width with your app) */
    .page-wrap { max-width: 900px; margin: 0 auto; padding: 24px 16px; }
    h1 { font-size: 1.5rem; margin: 0 0 12px; }
    p.desc { color: var(--muted, #6b7280); margin-bottom: 16px; }

    .card {
      background: var(--panel, #fff);
      color: var(--ink, #111827);
      border: 1px solid var(--line, #e5e7eb);
      border-radius: 12px;
      box-shadow: var(--shadow, 0 8px 24px rgba(0,0,0,.06));
      padding: 16px;
    }

    .controls { display: grid; gap: 12px; grid-template-columns: 1fr; }
    .row { display: grid; gap: 12px; grid-template-columns: 1fr auto auto; align-items: end; }
    @media (max-width: 640px){ .row { grid-template-columns: 1fr; } }

    input[type="file"] {
      background: var(--panel, #fff);
      border: 1px solid var(--line, #e5e7eb);
      border-radius: 8px;
      padding: 10px;
    }

    button {
      appearance: none; border: 0; cursor: pointer; font-weight: 700;
      padding: 10px 14px; border-radius: 10px;
      background: var(--brand, #253247); color: var(--brand-ink, #f8fafc);
      box-shadow: 0 2px 10px rgba(0,0,0,.08);
    }
    button[disabled] { opacity: .5; cursor: not-allowed; }

    .warn { background: #f59e0b1a; border: 1px solid #f59e0b66; color: #92400e; padding: 8px 10px; border-radius: 8px; }
    .danger { background: #ef44441a; border: 1px solid #ef444466; color: #7f1d1d; padding: 8px 10px; border-radius: 8px; }

    .grid { display: grid; gap: 16px; grid-template-columns: 1fr; }
    .split { display: grid; gap: 16px; grid-template-columns: 1fr; }
    @media (min-width: 900px){ .split { grid-template-columns: 1fr 1fr; } }

    /* Preview table */
    table { width: 100%; border-collapse: collapse; }
    th, td { text-align: left; padding: 8px 10px; border-bottom: 1px solid var(--line, #e5e7eb); }
    th { font-weight: 700; background: var(--tab-bg, var(--panel, #fff)); }
    caption { padding-top: 6px; font-size: .9rem; color: var(--muted, #6b7280); }

    /* Log area */
    #logArea {
      background: var(--panel, #fff);
      border: 1px solid var(--line, #e5e7eb);
      border-radius: 8px;
      padding: 10px;
      height: 220px;
      overflow: auto;
      white-space: pre-wrap;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 12.5px;
      line-height: 1.4;
    }
  </style>
</head>

<body>
  <div class="page-wrap">
    <header style="margin-bottom:16px;">
      <h1>Hospitals — Import CSV</h1>
      <p class="desc">Upload a CSV with headers <strong>Hosp_ID, HospName, Country</strong>. First click <em>Validate</em>, then <em>Replace hospitals</em> to delete and re-import the entire collection.</p>
      <div class="warn">Access note: You must be signed in and have role <strong>nurse</strong> to run the replace.</div>
    </header>

    <section class="card grid">
      <div class="controls">
        <div class="row">
          <label for="fileInput" style="font-weight:700;">CSV file</label>
          <input id="fileInput" type="file" accept=".csv" />
          <div style="display:flex; gap:8px; justify-self:end;">
            <button id="validateBtn" type="button">Validate</button>
            <button id="replaceBtn" type="button" title="Deletes all docs in 'hospitals' and imports CSV">Replace hospitals</button>
          </div>
        </div>
      </div>

      <div class="split">
        <div>
          <h2 style="font-size:1rem; margin:0 0 8px;">Preview</h2>
          <table id="previewTable" aria-label="Preview of parsed CSV rows"></table>
        </div>
        <div>
          <h2 style="font-size:1rem; margin:0 0 8px;">Log</h2>
          <div id="logArea" aria-live="polite"></div>
        </div>
      </div>

      <div class="danger" style="margin-top:4px;">
        Warning: “Replace hospitals” will <strong>delete all existing documents</strong> in the <code>hospitals</code> collection, then import rows from the CSV.
      </div>
    </section>
  </div>

  <!-- Config must export `firebaseConfig` -->
  <script type="module" src="/js/hospitals.js"></script>
</body>
</html>
